open Infer

let node model (prob, ()) = pr where
  rec init pr = sample (prob, Distribution.beta 1. 1.)
  and b = sample (prob, Distribution.bernoulli 0.7)
  and () = factor (prob, if b then log pr else log (1. -. pr))

let node main () =
  let d = infer 10000 model () in
  print_float (Distribution.mean_float d);
  print_newline ()
