open Infer_importance

let node geometric (prob, p) = geom where
  rec automaton
      | Incr ->
          do geom = 0. -> pre geom +. 1.
          until (sample (prob, Distribution.bernoulli p)) then Stop(geom)
      | Stop(n) -> do geom = n done
      end

let node main() =
  let d = infer 1000 geometric 0.1 in
  let mean, std = Distribution.stats_float d in
  print_float mean; print_string " "; print_float std; print_newline ()
